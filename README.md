# highThroughputScripts

I.  INTRO

This repository contains the scripts necessary for processing and fitting data from a titration sort 
as described in Whitney et al. (publication pending). The scripts are numbered and meant to be run 
in the order numbered. Syntax and descriptions are provided at the head of each script. 

MassTitr is a simple method for calculating the average bin position of a given FACS clone within an 
input library over a range of concentrations. The transition from saturably bound to unbound is 
captured in an ideal concentration range and will be reflected by the apparent surface Kd. 

Considerations are detailed in the supplemental methods portion of Whitney et al. (pending). Data
used in this pipeline was generated by an Illumina NextSeq500 sequencer, so there are only two 
input files for a single paired-end experiment. Also, our amplicon construction was such that the 
index reads for each position on the chip were not considered (barcodes were inline). 


II. USAGE 

Briefly, the scripts operate as described below: 

01_sort2Barcodes.py	 - Using forward and reverse fastq files, creates new fastq files using an input
legend for barcode sorting. 

02_getAASeq.sh - The purpose of this script is to take a single file containing sequential pairs
of forward and reverse reads, and to align each pair together to produce a single
DNA sequence, protein sequence, and set of quality scores.

03_countSequences.sh	- This script takes the output of the 02_align_reads script that consists of lines
containing a single DNA sequence each, and produces a "sequence hierarchy" file
that expresses the counts of various fragments of sequence.

04_cluster_sequence_counts.py	- Clusters the given sequence count hierarchy (e.g. the output of 
03_count_sequences.py) according to the tasks listed at the top of the script. One file will be written 
out for each task.

run_MassTitr.ipynb - (Jupyter Notebook) Loads the output of 04_cluster_sequence_counts.py and returns a list 
of csv files that are fitted for apparent surface affinity in the experiment. Functions also exist to 
plot results of individual clones, entire datasets against control titrations collected elsewhere, etc.



